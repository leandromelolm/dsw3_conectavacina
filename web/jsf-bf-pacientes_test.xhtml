<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <title>Pacientes</title>
    </h:head>
    <h:body>
        <ui:include src="menu.xhtml"/>
        <h2>Pacientes | Bootsfaces</h2>

        <b:growl id='gro' delay="4000"/>

        <p:messages id="messages" showDetail="true" closable="true">            
        </p:messages>

        <b:form id="formPaciente">

            <b:commandButton value="Novo registro" oncomplete="$('.modalcadastro').modal()" ajax="true"/>
            <p/>
            
            
            <b:dataTable id="tablePaciente" value="#{pacController.readAll()}" var="item">
                <b:dataTableColumn label="Código" value="#{item.id}"/>
                <b:dataTableColumn label="Nome" value="#{item.nome}"/> 
                
                                
                <b:dataTableColumn label="Nascimento" value="#{item.nascimento}" data-type="date"  />
                
                <b:dataTableColumn label="Nascimento" data-type="date">
                    
                    <p:calendar id="txtDataNascimento" disabled="true"
                                value="#{item.nascimento}" locale="en" navigator="true" pattern="dd/MM/yyyy" mask="true" /> 
                </b:dataTableColumn>
                
                                           
                
                
                <b:dataTableColumn label="Operações">
                    
                    <b:commandButton icon="search" ajax="true" oncomplete="$('.modalvisualiza').modal()" update=":modalVisualiza">
                        <f:setPropertyActionListener value="#{item}" target="#{pacController.selecao}"/>
                    </b:commandButton>
                    <b:commandButton icon="pencil" ajax="true" oncomplete="$('.modalaltera').modal()" update="formPaciente:modalAltera">
                        <f:setPropertyActionListener value="#{item}" target="#{pacController.selecao}"/>
                    </b:commandButton>
                    <b:commandButton icon="trash" ajax="true" oncomplete="$('.modaldeleta').modal()" update="@form">
                        <f:setPropertyActionListener value="#{item}" target="#{pacController.selecao}"/>
                    </b:commandButton>
                    
                </b:dataTableColumn>
            </b:dataTable>

            <b:modal id="modalDeleta" title="Operação" class="modaldeleta">
                <h:outputText value="Deseja realmente deletar usuário #{pacController.selecao.nome}, código #{pacController.selecao.id}"/><br/>
                <b:commandButton value="sim" action="#{pacController.delete()}" ajax="false"/>
                <b:button value="não" dismiss="modal"/>
            </b:modal>

            <b:modal id="modalAltera" title="Alterar cadastro" class="modalaltera">

                <b:panelGrid columns="2">
                    <h:outputText value ='Nome'/>                    
                    <b:inputText value="#{pacController.selecao.nome}"/>
                    
                    
                    <h:outputText value ='Data de nascimento'/>                    
                    
                    <!--<b:inputText value='#{pacController.selecao.nascimento}' />-->
                    
                    
                    
                    <h:outputText value ='Caracteristicas individuais'/>
                    <b:inputText value='#{pacController.selecao.caracteristicasIndividuais}'/>
                    <h:outputText value ='Grupo'/>
                    <b:inputText value='#{pacController.selecao.grupo}'/>
                    
                    
                </b:panelGrid>
                <b:commandButton value="alterar" action="#{pacController.update()}" ajax="false"/>
                <!--update=":formPaciente :formModal :gro :messages"/>-->
            </b:modal>

        </b:form>

        <b:modal id='modalCadastro' title="Cadastro de Profissional" class="modalcadastro">

            <b:form id="formModal">
                <b:panelGrid columns="2">
                    
                    <p:outputLabel value ='Nome'/>
                    <b:inputText value='#{pacController.cadastro.nome}'/>
                    
                    <p:outputLabel value ="Nascimento" for="txtDataNascimento" />
                    <p:calendar id="txtDataNascimento" value="#{pacController.cadastro.nascimento}"
                                        mask="true" pattern="dd/MM/yyyy" navigator="true" size="10">
                        <f:converter converterId="converterCalendar"/>
                    </p:calendar>
                                          
                    <p:outputLabel value ='Caracteristicas Pessoais'/>
                    <b:inputText value='#{pacController.cadastro.caracteristicasIndividuais}'/>
                    
                    
                    <p:outputLabel value="Grupo"/>
                    
<!--                    <c:forEach var="objeto" items="#{gController.readAll()}" end="4">
                         </c:forEach> -->
                    
                    <ui:repeat var="item" value="#{gController.readAll()}" >
                        <p:selectOneMenu var="item" value="#{pacController.cadastro.grupo}">
                            <f:selectItem noSelectionOption="true"
                                              itemLabel="Selecione um registro"/>
                            <f:selectItems value="#{item.denominacao}"
                                               />
                        </p:selectOneMenu>
                    </ui:repeat>
                    
                  
                </b:panelGrid>
                <b:commandButton value="cadastrar" action="#{pacController.insert(confirma)}" ajax="false"/>
                <!--update=":formPaciente :formModal :gro :messages"/>--> 
            </b:form>
        </b:modal>

        <b:modal id="modalVisualiza" title="Informações" class="modalvisualiza">

            <b:form id="formModalVisualiza">
                
                <b:panelGrid columns="2">
                    <h:outputText value ="Codigo: "/>
                    <h:outputText value="#{pacController.selecao.id}"/>
                    <h:outputText value ="Nome: "/>
                    <h:outputText value="#{pacController.selecao.nome}"/>
                    <h:outputText value ="Data de Nascimento:"/>
                    <!--<h:outputText value="#{pacController.selecao.nascimento}"/>-->
                    <h:outputText value ='Caracteristicas: '/>
                    <h:outputText value="#{pacController.selecao.caracteristicasIndividuais}"/>
                    <h:outputText value ="Grupo"/>
                    <h:outputText value="#{pacController.selecao.grupo}"/>
                    <h:outputText value ="Doses Recebidas"/>
                    <h:outputText value="#{pacController.selecao.aplicacao}"/>

                </b:panelGrid>
                <b:button value="close" dismiss="modal"/>
            </b:form>
        </b:modal>

    </h:body>

</html>

